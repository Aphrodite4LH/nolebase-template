# 5、进程间有哪些通信方式
## 匿名管道
是一种[[半双工与全双工|半双工]]的通信方式，数据只能单向流动而且只能在具有父子进程关系的进程间使用。

匿名管道是特殊的文件，只存在于内存，不存于文件系统中。
![[../../../../images/Pasted image 20240720000908.png]]

使用 `fork` 创建子进程，**创建的子进程会复制父进程的文件描述符**，这样就做到了两个进程各有两个`fd[0]` 与 `fd[1]`，两个进程就可以通过各自的 fd 写入和读取同一个管道文件实现跨进程通信了
![[../../../../images/Pasted image 20240720001006.png]]
## 命名管道：
类似匿名管道，也是半双工的通信方式，但是它**允许在不相关的进程间通信**。

命名管道提前创建了一个类型为管道的设备文件，在进程里只要使用这个设备文件，就可以相互通信。


## 消息队列
允许进程发送和接收消息，而**消息队列是保存在内核中的消息链表**，可以设置消息优先级。

消息队列生命周期随内核，如果没有释放消息队列或者没有关闭操作系统，消息队列会一直存在

## 信号
用于发送通知到进程，告知其发生了某种事件或条件。**对于异常情况下的工作模式，就需要用「信号」的方式来通知进程。**
```Shell
$ kill -l
 1) SIGHUP       2) SIGINT       3) SIGQUIT      4) SIGILL       5) SIGTRAP
 6) SIGABRT      7) SIGBUS       8) SIGFPE       9) SIGKILL     10) SIGUSR1
11) SIGSEGV     12) SIGUSR2     13) SIGPIPE     14) SIGALRM     15) SIGTERM
16) SIGSTKFLT   17) SIGCHLD     18) SIGCONT     19) SIGSTOP     20) SIGTSTP
21) SIGTTIN     22) SIGTTOU     23) SIGURG      24) SIGXCPU     25) SIGXFSZ
26) SIGVTALRM   27) SIGPROF     28) SIGWINCH    29) SIGIO       30) SIGPWR
31) SIGSYS      34) SIGRTMIN    35) SIGRTMIN+1  36) SIGRTMIN+2  37) SIGRTMIN+3
38) SIGRTMIN+4  39) SIGRTMIN+5  40) SIGRTMIN+6  41) SIGRTMIN+7  42) SIGRTMIN+8
43) SIGRTMIN+9  44) SIGRTMIN+10 45) SIGRTMIN+11 46) SIGRTMIN+12 47) SIGRTMIN+13
48) SIGRTMIN+14 49) SIGRTMIN+15 50) SIGRTMAX-14 51) SIGRTMAX-13 52) SIGRTMAX-12
53) SIGRTMAX-11 54) SIGRTMAX-10 55) SIGRTMAX-9  56) SIGRTMAX-8  57) SIGRTMAX-7
58) SIGRTMAX-6  59) SIGRTMAX-5  60) SIGRTMAX-4  61) SIGRTMAX-3  62) SIGRTMAX-2
63) SIGRTMAX-1  64) SIGRTMAX
```

**运行在 shell 终端**的进程，我们可以通过键盘输入某些组合键的时候，给进程发送信号。例如
- Ctrl+C 产生 `SIGINT` 信号，表示终止该进程；
- Ctrl+Z 产生 `SIGTSTP` 信号，表示停止该进程，但还未结束；

如果**进程在后台运行**，可以通过 `kill` 命令的方式给进程发送信号，但前提需要知道运行中的进程 PID 号，例如：
- `kill -9 1050` ，表示给 PID 为 1050 的进程发送 `SIGKILL` 信号，用来立即结束该进程；
## 共享内存
 就是映射一段能被其他进程所访问的内存，这段共享内存由一个进程创建，但多个进程都可以访问。共享内存是最快的进程通信方式。
 
 **共享内存的机制，就是让各个进程拿出一块虚拟地址空间来，映射到相同的物理内存中**。
![[../../../../images/Pasted image 20240720001519.png]]

## 信号量

信号量是一种用于管理并发进程访问共享资源的同步机制。主要有两种类型：
1. **计数信号量（Counting Semaphore）**：用于控制对某一资源的多个实例的访问，可以大于1
2. **二进制信号量（Binary Semaphore）**：又称互斥锁（Mutex），只能是0和1，用于控制对单个资源的访问。


**信号量其实是一个整型的计数器，主要用于实现进程间的互斥与同步，而不是用于缓存进程间通信的数据**。

信号量表示资源的数量，控制信号量的方式有两种原子操作：`P操作`与`V操作`
## `Socket`套接字
**跨网络与不同主机上的进程之间通信，就需要 Socket 通信了。**

根据创建 Socket 的类型不同，分为三种常见的通信方式，一个是基于 TCP 协议的通信方式，一个是基于 UDP 协议的通信方式，一个是本地进程间通信方式。