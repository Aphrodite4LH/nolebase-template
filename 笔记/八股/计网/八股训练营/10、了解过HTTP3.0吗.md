HTTP/3 是 HTTP 协议的最新版本，它基于 QUIC（Quick UDP Internet Connections）协议。QUIC 是由 Google 开发的一种新型传输层协议，旨在通过使用 UDP 提供更快、更可靠的互联网连接。

### 1. 无队头阻塞

**HTTP/1.1 和 HTTP/2**：
- 使用 TCP 进行传输。
- 虽然 HTTP/2 引入了多路复用，但由于 TCP 的队头阻塞问题，一个连接上的数据包丢失会导致后续所有数据包的传输延迟，直到丢失的数据包被重新传输。但==由于仍然依赖单一的TCP连接，如果该连接出现丢包或其他问题，整个连接上的所有流（请求）都会受到影响。==

**HTTP/3**：
- 使用 QUIC 协议，基于 UDP 进行传输。
- QUIC协议==将多个流嵌入到单个连接中，但每个流是独立的==。这意味着一个流中的丢包不会影响其他流的传输，从根本上解决了TCP层面的队头阻塞问题。
- 这种机制使得数据传输更加高效和可靠，特别是在高丢包率的网络环境中。

### 2. 零 RTT 连接建立

```ad-info
零RTT连接建立（0-RTT）是指客户端能够在首次发送数据包时就包含数据，而不必等待握手过程的完成。这极大地减少了连接建立的延迟，提升了用户体验。
```

- **初次连接**：
    
    - 当客户端第一次与服务器建立连接时，QUIC协议需要进行一次完整的握手过程，包括加密参数的协商。这与TCP + TLS 1.3的握手过程类似，通常需要一个RTT（Round-Trip Time）。
    - 在这个过程中，客户端和服务器交换密钥和会话信息，并生成==会话标识符==（Session Ticket）。
- **后续连接（0-RTT）**：
    
    - 客户端在首次连接后，会缓存与服务器协商的会话信息（如会话标识符）。
    - 当客户端再次与同一服务器建立连接时，可以使用之前缓存的会话信息发起0-RTT连接。
    - ==客户端发送包含数据的0-RTT数据包，并附带之前的会话标识符，服务器可以使用缓存的会话信息快速恢复加密状态==，解密并处理客户端的0-RTT数据包。
    - 如果会话标识符有效且未过期，服务器可以直接处理客户端的请求，从而实现零RTT的连接建立。

```ad-note
title: 连接ID和会话标识符的区别
- **连接ID**：
    
    - 用于==标识和管理QUIC连接==。
    - 在连接迁移和负载均衡中起关键作用。
    - 与网络路径无关，确保连接的连续性。
- **会话标识符**：
    
    - 用于==标识TLS加密会话==。
    - 在会话恢复和0-RTT连接建立中起关键作用。
    - 与加密握手相关，确保通信的安全性。
```
### 3. 连接迁移

**TCP 连接**：
- 在网络切换时（如从 Wi-Fi 切换到移动网络），TCP 连接通常会中断，需要重新建立。

**QUIC 连接**：
- 基于==连接ID==
- 支持连接迁移，允许在网络切换时将连接迁移到新的 IP 地址。
- 客户端和服务器可以继续使用现有的 QUIC 连接，无需重新建立连接，从而减少连接的中断时间，提高连接的稳定性。

### 4. 向前纠错机制

**传统数据传输**：
- 丢包后需要重传，导致延迟增加。

**QUIC 的向前纠错**：
- ==每个数据包除了它本身的内容外，还包括部分其他数据包的数据。==
- 当一个数据包丢失时，系统可以使用其他数据包的冗余数据进行重组，而无需立即重传丢失的数据包。


这种机制减少了因为丢包导致的数据重传，提高了传输效率。

### 5. 安全性

**HTTP/3 默认使用 TLS 加密**：
- 确保数据传输的安全性，防止数据在传输过程中被窃取或篡改。
- QUIC 内置了 TLS 1.3 加密协议，简化了安全配置，确保每个连接都是安全的。
