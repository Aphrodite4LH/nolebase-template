UDP它不属于连接型协议，因而具有资源消耗小，处理速度快的优点，所以通常音频、视频和普通数据在传送时使用UDP较多，因为它们即使偶尔丢失一两个数据包，也不会对接收结果产生太大影响。传输层无法保证数据的可靠传输，只能通过**应用层**来实现了。实现的方式可以参照tcp可靠性传输的方式，只是实现不在传输层，实现转移到了应用层。关键在于两点，从应用层角度考虑：

（1）提供超时重传，能避免数据报丢失。

（2）提供确认序列号，可以对数据报进行确认和排序。

**本端**：首先在UDP数据报定义一个首部，首部包含确认序列号和时间戳，时间戳是用来计算RTT(数据报传输的往返时间)，计算出合适的RTO(重传的超时时间)。然后以等-停的方式发送数据报，即收到对端的确认之后才发送下一个的数据报。当时间超时，本端重传数据报，同时RTO扩大为原来的两倍，重新开始计时。

```ad-note
#### 本端（发送端）：

1. **首部定义**：在UDP数据报中定义一个首部，包含以下字段：
    
    - 确认序列号（用于接收方确认收到的数据报）。
    - 时间戳（用于计算数据报传输的往返时间，RTT）。
2. **发送数据报**：以等-停（stop-and-wait）的方式发送数据报，即发送一个数据报后等待接收方的确认，再发送下一个数据报。
    
    - **发送过程**：
        - 发送数据报，并记录当前时间戳。
        - 设定RTO，开始计时。
        - 如果在RTO时间内收到ACK，继续发送下一个数据报。
        - 如果RTO超时未收到ACK，重传数据报，并倍增RTO，重新计时。
```

**对端**：接受到一个数据报之后取下该数据报首部的时间戳和确认序列号，并添加本端的确认数据报首部之后发送给对端。根据此序列号对已收到的数据报进行排序并丢弃重复的数据报。
```ad-note
#### 对端（接收端）：

1. **接收数据报**：
    
    - 接收到数据报后，提取首部的确认序列号和时间戳。
    - 根据序列号确认数据报是否已接收并排序。
    - 丢弃重复的数据报。
2. **发送ACK**：
    
    - 在ACK首部中包含接收的数据报的确认序列号和接收时间戳。
    - 发送ACK给发送方。
```