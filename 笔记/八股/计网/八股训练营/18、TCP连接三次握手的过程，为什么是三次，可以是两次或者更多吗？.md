
(1) 三次握手的过程

1. **第一次握手**：客户端向服务器发送一个`SYN` （同步序列编号）报文，请求建立连接，客户端进入`SYN_SENT` 状态。
2. **第二次握手**：服务器收到`SYN` 报文后，如果同意建立连接，则会发送一个`SYN-ACK` （同步确认）报文作为响应，同时进入`SYN_RCVD` 状态。
3. **第三次握手**：客户端收到服务器的`SYN-ACK` 报文后，会发送一个`ACK` （确认）报文作为最终响应，之后客户端和服务器都进入`ESTABLISHED` 状态，连接建立成功。
![[1720194377-a1caae677ce0df25d7547035fe1947ea.png|TCP 三次握手]]

(2)为什么需要三次握手

```ad-note
title: 我的理解
客户端：前两次握手让客户端确定了服务器有接收和发送的能力

服务器：第一次握手让服务器确定了客户端有发送的能力，第三次握手让服务器知道客户端有接收的能力
```
通过三次握手，客户端和服务器都能够确认对方的接收和发送能力。第一次握手确认了客户端到服务器的通道是开放的；第二次握手确认了服务器到客户端的通道是开放的；第三次握手则确认了客户端接收到服务器的确认，从而确保了双方的通道都是可用的。

而如果仅使用两次握手，服务器可能无法确定客户端的接收能力是否正常，比如客户端可能已经关闭了连接，但之前发送的连接请求报文在网络上延迟到达了服务器，服务器就会主动去建立一个连接，但是客户端接收不到，导致资源的浪费。而四次握手可以优化为三次。