![[Pasted image 20240713140057.png]]

1. 首先当然是TCP三次握手
2. 客户端发送TLS版本（SSL是TSL的前身）、加密套件、第1随机数
3. 服务器发送TLS版本、加密套件、第2随机数、CA证书、公钥
```ad-tip
现在服务器拥有了私钥、公钥、第1随机数、第2随机数

客户端有：公钥、第1随机数、第2随机数
```
4. 客户端生成第3随机数（预主密钥），然后使用公钥加密第3随机数，发给服务器
5. 服务器使用私钥解密预主密钥
```ad-tip
现在服务器拥有了私钥、公钥、第1随机数、第2随机数、预主密钥

客户端有：公钥、第1随机数、第2随机数、预主密钥
```
5. 客户端与服务器都使用第1随机数、第2随机数、预主密钥三者结合得到会话密钥
```ad-note
上面是==非对称加密==（非对称加密使用一对密钥：公钥和私钥。公钥用于加密数据，私钥用于解密数据。公钥可以公开发布，而私钥必须保密。非对称加密确保了只有持有私钥的人可以解密用公钥加密的数据。）


下面是==对称加密==（对称加密使用同一个密钥进行加密和解密。）
```
6. 接下来的整个会话都使用此会话密钥加密与解密